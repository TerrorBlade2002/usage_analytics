<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT Analytics | Astra Global</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Background Watermark -->
    <div class="background-watermark"></div>

    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <img src="/assets/astra_logo.jpg" alt="Astra Global" class="logo-img">
                    <div class="logo-text">
                        <h1>GPT Analytics</h1>
                        <span>Astra Global Workspace</span>
                    </div>
                </div>
                <div class="header-actions">
                    <div class="status-indicator" id="status">
                        <span class="status-dot"></span>
                        <span class="status-text">Connecting...</span>
                    </div>
                    <button class="btn-refresh" onclick="refreshData()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path
                                d="M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15" />
                        </svg>
                        Refresh
                    </button>
                </div>
            </div>
        </header>

        <!-- Portfolio Conveyor Belt -->
        <div class="conveyor-wrapper">
            <div class="conveyor-belt">
                <div class="conveyor-track" id="conveyor-track">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="main">
            <!-- Stats Overview -->
            <section class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="total-interactions">-</div>
                        <div class="stat-label">Total Interactions</div>
                    </div>
                    <div class="stat-glow blue"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon purple">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                            <circle cx="9" cy="7" r="4" />
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" />
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="total-sessions">-</div>
                        <div class="stat-label">Total Sessions</div>
                    </div>
                    <div class="stat-glow purple"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon green">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                            <line x1="16" y1="2" x2="16" y2="6" />
                            <line x1="8" y1="2" x2="8" y2="6" />
                            <line x1="3" y1="10" x2="21" y2="10" />
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="today-interactions">-</div>
                        <div class="stat-label">Today's Activity</div>
                    </div>
                    <div class="stat-glow green"></div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon orange">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" />
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-value" id="today-sessions">-</div>
                        <div class="stat-label">Active Today</div>
                    </div>
                    <div class="stat-glow orange"></div>
                </div>
            </section>

            <!-- Content Grid -->
            <section class="content-grid">
                <!-- Portfolios Table -->
                <div class="card table-card">
                    <div class="card-header">
                        <h2>Portfolio Analytics</h2>
                        <span class="badge">10 Portfolios</span>
                    </div>
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Portfolio</th>
                                    <th>Interactions</th>
                                    <th>Sessions</th>
                                    <th>Today</th>
                                    <th>Last Active</th>
                                </tr>
                            </thead>
                            <tbody id="portfolios-table">
                                <tr>
                                    <td colspan="5" class="loading-row">
                                        <div class="loading-spinner"></div>
                                        Loading portfolios...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Chart -->
                <div class="card chart-card">
                    <div class="card-header">
                        <h2>Activity Trend</h2>
                        <span class="badge">Last 30 Days</span>
                    </div>
                    <div class="chart-container">
                        <canvas id="dailyChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Distribution Chart -->
            <section class="distribution-section">
                <div class="card">
                    <div class="card-header">
                        <h2>Portfolio Distribution</h2>
                    </div>
                    <div class="distribution-container">
                        <div class="chart-wrapper">
                            <canvas id="distributionChart"></canvas>
                        </div>
                        <div class="distribution-legend" id="distribution-legend"></div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <span>Last updated: <span id="last-updated">Never</span></span>
                <span class="footer-divider">•</span>
                <span>Auto-refresh every 30 seconds</span>
            </div>
        </footer>
    </div>

    <!-- Drill-Down Modal -->
    <div class="modal-overlay" id="modal-overlay" onclick="closeModal()">
        <div class="modal" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="modal-title">
                    <img id="modal-portfolio-img" src="" alt="" class="modal-portfolio-img">
                    <div>
                        <h2 id="modal-portfolio-name">Portfolio Name</h2>
                        <span class="modal-subtitle">Detailed Analytics</span>
                    </div>
                </div>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body">
                <!-- Modal Stats -->
                <div class="modal-stats">
                    <div class="modal-stat">
                        <div class="modal-stat-value" id="modal-total-interactions">-</div>
                        <div class="modal-stat-label">Total Interactions</div>
                    </div>
                    <div class="modal-stat">
                        <div class="modal-stat-value" id="modal-total-sessions">-</div>
                        <div class="modal-stat-label">Total Sessions</div>
                    </div>
                    <div class="modal-stat">
                        <div class="modal-stat-value" id="modal-active-days">-</div>
                        <div class="modal-stat-label">Active Days</div>
                    </div>
                    <div class="modal-stat">
                        <div class="modal-stat-value" id="modal-avg-per-day">-</div>
                        <div class="modal-stat-label">Avg/Day</div>
                    </div>
                </div>

                <!-- Activity Chart -->
                <div class="modal-chart-section">
                    <h3>Daily Activity (Last 30 Days)</h3>
                    <div class="modal-chart-container">
                        <canvas id="modalDailyChart"></canvas>
                    </div>
                </div>

                <!-- Session vs Interaction Ratio -->
                <div class="modal-chart-section">
                    <h3>Interactions per Session</h3>
                    <div class="modal-chart-container small">
                        <canvas id="modalRatioChart"></canvas>
                    </div>
                </div>

                <!-- Recent Queries -->
                <div class="modal-chart-section">
                    <h3>Recent Queries</h3>
                    <div class="recent-queries-list" id="recent-queries-list">
                        <p class="loading-text">Loading queries...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>